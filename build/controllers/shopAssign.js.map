{"version":3,"sources":["../../src/controllers/shopAssign.js"],"names":["shopAssignController","create","req","res","body","shopAssign","result","status","json","dataValues","send","update","where","id","params","getAll","pageNo","page","offset","limit","findAll","getShops","shop","visitDay","day","attributes","include","exclude","association","userId","console","log","module","exports"],"mappings":"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","sourcesContent":["import { shopAssign, shop } from '../database/models';\nvar shopAssignController = {};\n\nshopAssignController.create = async (req, res) => {\n    try {\n        let body = req.body;\n        const result = await shopAssign.create(body);\n        res.status(200).json(result.dataValues);\n    }\n    catch (error) {\n        res.status(400).send(error);\n    }\n}\n\nshopAssignController.update = async (req, res) => {\n    try {\n        let body = req.body;\n        const result = await shopAssign.update(body, {\n            where: {\n                id: req.params.id\n            }\n        });\n        res.status(200).json(result);\n    } catch (error) {\n        res.status(400).send(error);\n    }\n}\n\nshopAssignController.getAll = async (req, res) => {\n    try {\n        let pageNo = req.params.page;\n        let offset = (pageNo - 1) * 15;\n        let limit = 15;\n        const result = await shopAssign.findAll({ offset, limit });\n        res.status(200).json(result);\n    } catch (error) {\n        res.status(400).send(error);\n    }\n}\n\nshopAssignController.getShops = async (req, res) => {\n    try {\n        // const values = await shopAssign.findAll({\n        //     attributes: ['shopId'],\n        //     where: {\n        //         userId: req.params.userId,\n        //         status: 'assigned'\n        //     },\n        //     raw: true\n        // });\n\n        // console.log(values);\n        // let shopIds = values.map(value => value.shopId);\n        // console.log(shopIds);\n        let result = await shop.findAll({\n            where: {\n                visitDay: req.params.day\n            },\n            attributes: { include: [['id', 'shopId']], exclude: ['id', 'visitDay', 'createdAt', 'updatedAt'] },\n            include: [{\n                association: 'shopAssignUsers', where: { id: req.params.userId },\n                attributes: {\n                    include: [['id', 'userId']],\n                    exclude: ['id', 'username', 'password', 'mobile', 'imei',\n                        'role', 'zone', 'region', 'createdAt', 'updatedAt']\n                }\n            }]\n        });\n        res.status(200).json(result);\n    } catch (error) {\n        console.log(error);\n        res.status(400).send(error);\n    }\n}\n\nmodule.exports = shopAssignController;"],"file":"shopAssign.js"}